<!DOCTYPE html>
<html lang="pt">
<head>
    <meta charset="UTF-8">
    <link rel="stylesheet" href="style.css">
    <title>Alterar Aluno</title>

    <script>
        function incluirAluno ()
        {
            let nome = document.getElementById("nome").value;
            let mat = document.getElementById("mat").value;
            let email = document.getElementById("email").value;
            let cpf = document.getElementById("cpf").value;

            let xmlhttp = new XMLHttpRequest();
            xmlhttp.onreadystatechange = function() 
            {
                if (this.readyState == 4 && this.status == 200) 
                {
                    document.getElementById("resultado").innerHTML = this.responseText;
                }
            };
            xmlhttp.open("GET", "http://localhost/3dawmanha/incluirAluno?nome=" + pNome +"&email=" + email + "&cpf=" 
            + cpf + "&matricula=" + mat);
            xmlhttp.send();   
        }
        function listarAlunos ()
        {
            let xmlhttp = new XMLHttpRequest();
            xmlhttp.onreadystatechange = function() 
            {
                if (this.readyState == 4 && this.status == 200) 
                {
                    document.getElementById("resultado").innerHTML = this.responseText;
                }
            };
            let obj = JSON.parse (this.responseText);
            let x=0;
            let txt = "<table border='1'>";
            txt += "<tr><th>Nome</th><th>Matricula</th><th>Email</th><th>CPF</th></tr>";
            for (x in obj)
            {
                txt += "<tr><td>" + obj[x].nome + "</td><td>" + obj[x].matricula + "</td><td>" + obj[x].email + "</td><td>" + obj[x].cpf + "</td></tr>";
            }
            txt += "</table>";
            document.getElementById("resultado").innerHTML = txt;
            xmlhttp.open("GET", "http://localhost/3dawmanha/listarAlunos_JS.php");
            xmlhttp.send();
        }
        function enviarForm ()
        {
            let id = document.getElementById("id").value;
            let nome = document.getElementById("nomeAlt").value;
            let periodo = document.getElementById("periodoAlt").value;
            let preRequisito = document.getElementById("preRequisitoAlt").value;
            let credito = document.getElementById("creditoAlt").value;

            let xmlHttp = new XMLHttpRequest();
            xmlHttp.onreadystatechange = function() 
            {
                if (this.readyState == 4 && this.status == 200) 
                {
                    document.getElementById("resultado").innerHTML = this.responseText;
                }
            };
            xmlHttp.open("GET", "http://localhost/3dawmanha/alterarDisciplina?nome=" + nome + "&periodo=" + periodo + "&preRequisito=" + preRequisito + "&credito=" + credito + "&id=" + id);
            xmlHttp.send();
        }
        function alterarDisciplina ()
        {
            let id = document.getElementById("id").value;
            let nome = document.getElementById("nomeAlt").value;
            let periodo = document.getElementById("periodoAlt").value;
            let preRequisito = document.getElementById("preRequisitoAlt").value;
            let credito = document.getElementById("creditoAlt").value;

            let xmlHttp = new XMLHttpRequest();
            xmlHttp.onreadystatechange = function() 
            {
                if (this.readyState == 4 && this.status == 200) 
                {
                    document.getElementById("resultado").innerHTML = this.responseText;
                }
            };
            xmlHttp.open("GET", "http://localhost/3dawmanha/alterarDisciplina?nome=" + nome + "&periodo=" + periodo + "&preRequisito=" + preRequisito + "&credito=" + credito + "&id=" + id);
            xmlHttp.send();
        }
        function alterarAluno ()
        {
            let nome = document.getElementById("nome").value;
            let mat = document.getElementById("mat").value;
            let email = document.getElementById("email").value;
            let cpf = document.getElementById("cpf").value;

            let xmlhttp = new XMLHttpRequest();
            xmlhttp.onreadystatechange = function() 
            {
                if (this.readyState == 4 && this.status == 200) 
                {
                    document.getElementById("resultado").innerHTML = this.responseText;
                }
            };
            xmlhttp.open("GET", "http://localhost/3dawmanha/alterarAluno?nome=" + nome + "&matricula=" + mat + "&email=" + email + "&cpf=" + cpf);
            xmlhttp.send();
        }
        function buscaDisciplina()
        {
            let id = document.getElementById("id").value;
            let xmlHttp = new XMLHttpRequest();

            xmlHttp.onreadystatechange = function() {
                if (this.readyState == 4 && this.status == 200) {
                    let obj = JSON.parse(this.responseText);

                    document.getElementById("nomeAlt").value = obj.nome;
                    document.getElementById("periodoAlt").value = obj.periodo;
                    document.getElementById("preRequisitoAlt").value = obj.idPreRequisito;
                    document.getElementById("creditoAlt").value = obj.credito;
            
                }
            };
        }
      
        
    </script>
</head>
<body style="background-color: rgb(230, 222, 199);">
    <h1>Alteração de Dados</h1>
    <form>
        <label for="id">ID:</label>
        <input type="text" id="id" name="id" onblur="buscaDisciplina()">
        <br>
        <label for="nomeAlt">Nome:</label>
        <input type="text" id="nomeAlt" name="nomeAlt">
        <br>
        <label for="periodoAlt">Periodo:</label>
        <input type="text" id="periodoAlt" name="periodoAlt">
        <br>
        <label for="preRequisitoAlt">Pre-Requisito:</label>
        <input type="text" id="preRequisitoAlt" name="preRequisitoAlt">
        <br>
        <label for="creditoAlt">Crédito:</label>
        <input type="text" id="creditoAlt" name="creditoAlt">
        <br>
        <input type="button" value="Alterar" onclick="alterarDisciplina()">
    </form>
    <a href="index.html">Voltar</a>
</body>
</html>
